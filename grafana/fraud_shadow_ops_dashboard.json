{
  "dashboard": {
    "title": "Fraud Shadow Ops Metrics (Shadow Pilot)",
    "tags": ["fraud", "dark-graph", "advisory", "shadow"],
    "timezone": "browser",
    "panels": [
      {
        "id": 1,
        "title": "Shadow Fraud Score Distribution",
        "type": "histogram",
        "targets": [
          {
            "expr": "histogram_quantile(0.50, fraud_shadow_score_bucket)",
            "legendFormat": "p50 Fraud Score"
          },
          {
            "expr": "histogram_quantile(0.75, fraud_shadow_score_bucket)",
            "legendFormat": "p75 Fraud Score"
          },
          {
            "expr": "histogram_quantile(0.95, fraud_shadow_score_bucket)",
            "legendFormat": "p95 Fraud Score"
          }
        ],
        "description": "Model sanity: Distribution of fraud risk scores"
      },
      {
        "id": 2,
        "title": "% of Transactions Flagged",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(fraud_shadow_flagged_total) / sum(fraud_shadow_transactions_total) * 100",
            "legendFormat": "% Flagged"
          }
        ],
        "description": "False-positive control: Percentage of transactions flagged as fraud"
      },
      {
        "id": 3,
        "title": "Time-to-Flag (ms)",
        "type": "timeseries",
        "targets": [
          {
            "expr": "avg(fraud_shadow_time_to_flag_ms)",
            "legendFormat": "Avg Time-to-Flag"
          },
          {
            "expr": "quantile(0.95, fraud_shadow_time_to_flag_ms)",
            "legendFormat": "p95 Time-to-Flag"
          }
        ],
        "description": "Detection speed: Time from transaction to flag"
      },
      {
        "id": 4,
        "title": "Device Reuse Clusters",
        "type": "stat",
        "targets": [
          {
            "expr": "count(count by (device_reuse_cluster_id) (fraud_shadow_device_reuse_total))",
            "legendFormat": "Active Mule Clusters"
          }
        ],
        "description": "Mule visibility: Number of active device reuse clusters"
      },
      {
        "id": 5,
        "title": "Merchant Drift Score",
        "type": "timeseries",
        "targets": [
          {
            "expr": "avg(fraud_shadow_merchant_drift_score)",
            "legendFormat": "Avg Merchant Drift"
          },
          {
            "expr": "max(fraud_shadow_merchant_drift_score)",
            "legendFormat": "Max Merchant Drift"
          }
        ],
        "description": "Terminal compromise: Merchant drift scores over time"
      },
      {
        "id": 6,
        "title": "Cross-CU Propagation",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(fraud_shadow_cross_cu_propagation_total)",
            "legendFormat": "Cross-CU Fraud Patterns"
          }
        ],
        "description": "National threat proof: Fraud patterns propagating across CUs"
      },
      {
        "id": 7,
        "title": "Confirmed Fraud Correlation",
        "type": "table",
        "targets": [
          {
            "expr": "sum(fraud_shadow_confirmed_fraud_total) / sum(fraud_shadow_flagged_total) * 100",
            "legendFormat": "Precision %"
          },
          {
            "expr": "sum(fraud_shadow_confirmed_fraud_total) / sum(fraud_actual_fraud_total) * 100",
            "legendFormat": "Recall %"
          },
          {
            "expr": "sum(fraud_shadow_flagged_total) - sum(fraud_shadow_confirmed_fraud_total)",
            "legendFormat": "False Positives"
          }
        ],
        "description": "Model validation: Precision, Recall, False Positives"
      },
      {
        "id": 8,
        "title": "Fraud Risk Band Distribution",
        "type": "piechart",
        "targets": [
          {
            "expr": "sum by (risk_band) (fraud_shadow_risk_band_total)",
            "legendFormat": "{{risk_band}}"
          }
        ],
        "description": "Risk band distribution: LOW, MEDIUM, HIGH"
      },
      {
        "id": 9,
        "title": "Model Performance Over Time",
        "type": "timeseries",
        "targets": [
          {
            "expr": "rate(fraud_shadow_confirmed_fraud_total[1h]) / rate(fraud_shadow_flagged_total[1h])",
            "legendFormat": "Precision (1h rolling)"
          },
          {
            "expr": "avg(fraud_shadow_confidence_interval)",
            "legendFormat": "Avg Confidence"
          }
        ],
        "description": "Model maturity: Precision and confidence over time"
      },
      {
        "id": 10,
        "title": "Board Weekly Fraud Summary",
        "type": "table",
        "targets": [
          {
            "expr": "sum(fraud_shadow_flagged_total)",
            "legendFormat": "Total Flags Raised"
          },
          {
            "expr": "sum(fraud_shadow_confirmed_fraud_total)",
            "legendFormat": "Confirmed Fraud Cases"
          },
          {
            "expr": "sum(fraud_shadow_confirmed_fraud_total) / sum(fraud_shadow_flagged_total) * 100",
            "legendFormat": "Precision %"
          },
          {
            "expr": "avg(fraud_shadow_time_to_flag_ms)",
            "legendFormat": "Avg Time-to-Flag (ms)"
          },
          {
            "expr": "sum(fraud_shadow_cross_cu_propagation_total)",
            "legendFormat": "Cross-CU Patterns Detected"
          }
        ],
        "description": "Board-ready summary metrics for weekly reporting"
      }
    ],
    "refresh": "30s",
    "time": {
      "from": "now-7d",
      "to": "now"
    }
  }
}
